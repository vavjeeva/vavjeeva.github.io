<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-bounce.min.css?v=1.0.2">























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"perspectiveLeftIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="In this article, I will discuss about how to do real-time translation chat using any language of choice in two way communication using SignalR and Cognitive Services Translate API and one of the new f">
<meta name="keywords" content="C#,.Net Core,Azure,SignalR,HttpClient,CognitiveService">
<meta property="og:type" content="article">
<meta property="og:title" content="Real time Language Translation chat using SignalR and Azure Cognitive Services and TypedHttpClient - .Net Core 2.1">
<meta property="og:url" content="https://jeevasubburaj.com/2018/06/06/real-time-language-translation-chat/index.html">
<meta property="og:site_name" content="Jeeva Subburaj - Programmer, Blogger">
<meta property="og:description" content="In this article, I will discuss about how to do real-time translation chat using any language of choice in two way communication using SignalR and Cognitive Services Translate API and one of the new f">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://1.bp.blogspot.com/-JSQ-7JklFio/WxqbyJV6W1I/AAAAAAAGszw/HUt2nhTo88AxpvQKw2fzWTXpoRUCK40AgCLcBGAs/s1600/Chat_Window.png">
<meta property="og:image" content="https://2.bp.blogspot.com/-AZUqwiZWZ-c/WxqYb9xTMJI/AAAAAAAGszk/_OZugp5NRl868pJssvpuOINUsbk9yVRIQCLcBGAs/s1600/SignalR_Chat_Architecture.png">
<meta property="og:image" content="https://lh3.googleusercontent.com/-rJkV6udhFUM/WxgF2VlY0UI/AAAAAAAGswA/XfX9FDS_zV4L5oRK0VCp9WDFxBRKblzlQCHMYCw/New_Project_thumb%255B5%255D?imgmax=800">
<meta property="og:image" content="https://lh3.googleusercontent.com/-T4zt0S1ZAfo/WxgF6wgCtYI/AAAAAAAGswI/60tfKd9tQcwr7mNmUYQ3wL1imNg02DQIQCHMYCw/New_Project_Web_App_thumb%255B4%255D?imgmax=800">
<meta property="og:image" content="https://lh3.googleusercontent.com/-gQi-ABxwYjA/WxgwUxxY2CI/AAAAAAAGsw4/IEJVtVz3D5QIoNdRSa_X3dTUNzIMMvmZACHMYCw/1_thumb%255B1%255D?imgmax=800">
<meta property="og:image" content="https://lh3.googleusercontent.com/-hdnP1JOxd4A/WxgwaPgOcQI/AAAAAAAGsxA/Xj4FqbgtN5M4Fx7GSHXpeRGsc-TIZiYhACHMYCw/1.1_thumb%255B2%255D?imgmax=800">
<meta property="og:image" content="https://lh3.googleusercontent.com/-8ShphCc0EFM/WxgwenjT0bI/AAAAAAAGsxI/o7GdGBI3vjwbLiNPwAKPtD5Jdk_608pDACHMYCw/Pricing_Tier_thumb%255B1%255D?imgmax=800">
<meta property="og:image" content="https://lh3.googleusercontent.com/-SBFmGqHxSvw/WxgwikiJUBI/AAAAAAAGsxU/5Q8qC3vA7Kg6Nuoor0m17fdWJIy56uJ_ACHMYCw/2_thumb%255B2%255D?imgmax=800">
<meta property="og:image" content="https://lh3.googleusercontent.com/-koHx0nz4gUs/WxgwnYekzoI/AAAAAAAGsxc/eRIhChSgBm8nMOXaxjUHa-PwQy6csOt3wCHMYCw/3_thumb%255B3%255D?imgmax=800">
<meta property="og:updated_time" content="2019-03-15T17:33:29.163Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Real time Language Translation chat using SignalR and Azure Cognitive Services and TypedHttpClient - .Net Core 2.1">
<meta name="twitter:description" content="In this article, I will discuss about how to do real-time translation chat using any language of choice in two way communication using SignalR and Cognitive Services Translate API and one of the new f">
<meta name="twitter:image" content="https://1.bp.blogspot.com/-JSQ-7JklFio/WxqbyJV6W1I/AAAAAAAGszw/HUt2nhTo88AxpvQKw2fzWTXpoRUCK40AgCLcBGAs/s1600/Chat_Window.png">



  <link rel="alternate" href="/atom.xml" title="Jeeva Subburaj - Programmer, Blogger" type="application/atom+xml">




  <link rel="canonical" href="https://jeevasubburaj.com/2018/06/06/real-time-language-translation-chat/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Real time Language Translation chat using SignalR and Azure Cognitive Services and TypedHttpClient - .Net Core 2.1 | Jeeva Subburaj - Programmer, Blogger</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jeeva Subburaj - Programmer, Blogger</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jeevasubburaj.com/2018/06/06/real-time-language-translation-chat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeeva Subburaj">
      <meta itemprop="description" content="Programmer, Blogger">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jeeva Subburaj - Programmer, Blogger">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Real time Language Translation chat using SignalR and Azure Cognitive Services and TypedHttpClient - .Net Core 2.1

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-06-06 15:38:00" itemprop="dateCreated datePublished" datetime="2018-06-06T15:38:00-04:00">2018-06-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-15 13:33:29" itemprop="dateModified" datetime="2019-03-15T13:33:29-04:00">2019-03-15</time>
              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2018/06/06/real-time-language-translation-chat/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/06/06/real-time-language-translation-chat/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>In this article, I will discuss about how to do real-time translation chat using any language of choice in two way communication using SignalR and Cognitive Services Translate API and one of the new feature .Net Core 2.1 <strong>HttpClientFactory â€“ TypedHttpClient</strong> to make API calls.  </p>
<p>This is a simple chat application for user to login with name and choice of language to send and receive the message. When the user sends the message, signalR hub receives the message and send the API request to Azure Cognitive Translate API Library and receives the translated text and send it back to user in real time. SignalR Hub creates the group of users based on language so that when the translated text comes back from API, it broadcast back to the group based on the language.  </p>
<a id="more"></a>
<p>[<img src="https://1.bp.blogspot.com/-JSQ-7JklFio/WxqbyJV6W1I/AAAAAAAGszw/HUt2nhTo88AxpvQKw2fzWTXpoRUCK40AgCLcBGAs/s1600/Chat_Window.png" alt>](<a href="https://1.bp.blogspot.com/-JSQ-7JklFio/WxqbyJV6W1I/AAAAAAAGszw/HUt2nhTo88AxpvQKw2fzWTXpoRUCK40AgCLcBGAs/s1600/Chat_Window.png" target="_blank" rel="noopener">https://1.bp.blogspot.com/-JSQ-7JklFio/WxqbyJV6W1I/AAAAAAAGszw/HUt2nhTo88AxpvQKw2fzWTXpoRUCK40AgCLcBGAs/s1600/Chat_Window.png</a></p>
<p><strong>Video Demo</strong><br><div class="video-container"><iframe src="//www.youtube.com/embed/d2NXV3FRunU" frameborder="0" allowfullscreen></iframe></div></p>
<h2 id="Architecture-amp-How-it-Works"><a href="#Architecture-amp-How-it-Works" class="headerlink" title="Architecture &amp; How it Works?"></a>Architecture &amp; How it Works?</h2><p><img src="https://2.bp.blogspot.com/-AZUqwiZWZ-c/WxqYb9xTMJI/AAAAAAAGszk/_OZugp5NRl868pJssvpuOINUsbk9yVRIQCLcBGAs/s1600/SignalR_Chat_Architecture.png" alt></p>
<p>Realtime Chat application is developed in .Net Core Web App using Razor Pages with Bootstrap layout and .Net Core SignalR Library .  </p>
<p>When the user login with the name and choice of language they selected, system is establishing the connection with SignalRHub and put the user into the selected language group. It also notifies all the other users that new user is joined.  </p>
<p>When the user sends the message, SignalRHub makes the Web API call with Cognitive Services API to get the translated message and sending the translated message to other members in their selected languages real-time.  </p>
<p>When the user exits the chat, it removes from the group and also notifies the other users.  </p>
<p><strong>Steps</strong>-   Create a New Razor Web App with Login and Chat Pages and Adding SignalR Libraries</p>
<ul>
<li>Create a SignalR Hub and Register with Web App</li>
<li>Create and Consume Cognitive Services in Azure (Free Tier)</li>
</ul>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><ul>
<li>Visual Studio 2017 v 15.7.3 or above</li>
<li>.Net Core SDK 2.1</li>
</ul>
<h2 id="Creating-a-New-Razor-Web-App-amp-Adding-SignalR-Libraries"><a href="#Creating-a-New-Razor-Web-App-amp-Adding-SignalR-Libraries" class="headerlink" title="Creating a New Razor Web App &amp; Adding SignalR Libraries"></a>Creating a New Razor Web App &amp; Adding SignalR Libraries</h2><ul>
<li>Launch the Visual Studio and use the  <strong>File</strong>  &gt;  <strong>New Project</strong>  menu option and choose  <strong>ASP.NET Core Web Application</strong>. Name the project  <em>RealTimeTranslationChat</em>.<br><a href="https://lh3.googleusercontent.com/-EKveFq5VAEo/WxgFzPthxkI/AAAAAAAGsv8/rH07BUMx7tAviWyvSszzY5rHxtnBrpStgCHMYCw/s1600-h/New_Project%255B7%255D" target="_blank" rel="noopener"><img src="https://lh3.googleusercontent.com/-rJkV6udhFUM/WxgF2VlY0UI/AAAAAAAGswA/XfX9FDS_zV4L5oRK0VCp9WDFxBRKblzlQCHMYCw/New_Project_thumb%255B5%255D?imgmax=800" alt="New_Project" title="New_Project"></a>-   Select the Web Application and make sure Asp.Net Core 2.1 is selected.<br><a href="https://lh3.googleusercontent.com/-xqdkpEApC3c/WxgF47-cj1I/AAAAAAAGswE/fdOfNxgDzQca_gzRwQSafVuzZO-GeQR3gCHMYCw/s1600-h/New_Project_Web_App%255B6%255D" target="_blank" rel="noopener"><img src="https://lh3.googleusercontent.com/-T4zt0S1ZAfo/WxgF6wgCtYI/AAAAAAAGswI/60tfKd9tQcwr7mNmUYQ3wL1imNg02DQIQCHMYCw/New_Project_Web_App_thumb%255B4%255D?imgmax=800" alt="New_Project_Web_App" title="New_Project_Web_App"></a>-   </li>
</ul>
<p>By default, the  <strong>Microsoft.AspNetCore.SignalR</strong>  package containing its server libraries as part of its ASP.NET Core Web Application template. However, the JavaScript client library for SignalR must be installed using npm. Use the following commands from Node Package Manager Console to install it and copy the signalr.js file from  <strong>node_modules\@aspnet\signalr\dist\browser</strong>  to  <strong>wwwroot\lib\signalr\signalr.js</strong>. (Create a SignalR Folder under Lib Directory)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm init -y </span><br><span class="line">npm install @aspnet/signalr</span><br></pre></td></tr></table></figure>
<h2 id="Create-the-SignalRHub-and-Register-with-Web-App"><a href="#Create-the-SignalRHub-and-Register-with-Web-App" class="headerlink" title="Create the SignalRHub and Register with Web App"></a>Create the SignalRHub and Register with Web App</h2><ul>
<li>Create a New folder called Models and add a User model class.<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        public string Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        public string LanguagePreference &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        public string ConnectionId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>This model class holds the Name and the Language preference selected by user and the SignalR Connection ID.</p>
<ul>
<li>Create a New Folder called Hubs and add a new class called ChatHub.cs<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ChatHub</span> : <span class="title">Hub</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> CognitiveServiceClient _client;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ChatHub</span>(<span class="params">CognitiveServiceClient client</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            _client = client;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">static</span> List&lt;user&gt; ConnectedUsers = <span class="keyword">new</span> List&lt;user&gt;();</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> User CurrentUser</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ConnectedUsers.FirstOrDefault(i =&gt; i.ConnectionId == Context.ConnectionId);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> LanguageFormatted</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">string</span> result = <span class="string">""</span>;</span><br><span class="line">                <span class="keyword">var</span> items = ConnectedUsers.Select(i =&gt; i.LanguagePreference).Distinct();</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> language <span class="keyword">in</span> items)</span><br><span class="line">                &#123;</span><br><span class="line">                    result += <span class="string">$"to=<span class="subst">&#123;language&#125;</span>&amp;"</span>;</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">if</span> (result.Length &gt; <span class="number">1</span>)</span><br><span class="line">                    result = result.Substring(<span class="number">0</span>, result.Length - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">SendMessage</span>(<span class="params"><span class="keyword">string</span> user, <span class="keyword">string</span> message</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">var</span> results = _client.Translate(message, LanguageFormatted);</span><br><span class="line">            <span class="keyword">var</span> translationResult = results.Result.FirstOrDefault();</span><br><span class="line">            <span class="keyword">if</span> (translationResult != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> translation <span class="keyword">in</span> translationResult.translations)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">await</span> Clients.GroupExcept(translation.to, Context.ConnectionId).SendAsync(<span class="string">"ReceiveMessage"</span>, user, translation.text);</span><br><span class="line">                    <span class="comment">//await Clients.AllExcept(Context.ConnectionId).SendAsync("ReceiveMessage", user, message);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">Connect</span>(<span class="params"><span class="keyword">string</span> name, <span class="keyword">string</span> language</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">var</span> id = Context.ConnectionId;</span><br><span class="line">            <span class="keyword">if</span> (ConnectedUsers.Count(x =&gt; x.ConnectionId == id) == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ConnectedUsers.Add(<span class="keyword">new</span> User() &#123; Name = name, ConnectionId = id, LanguagePreference = language &#125;);</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">await</span> Groups.AddToGroupAsync(id, language);</span><br><span class="line">                <span class="keyword">await</span> Clients.Caller.SendAsync(<span class="string">"onConnected"</span>, ConnectedUsers, name, id);</span><br><span class="line">                <span class="keyword">await</span> Clients.AllExcept(id).SendAsync(<span class="string">"onNewUserConnected"</span>, name);</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">Disconnect</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">var</span> item = ConnectedUsers.FirstOrDefault(x =&gt; x.ConnectionId == Context.ConnectionId);</span><br><span class="line">            <span class="keyword">if</span> (item != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ConnectedUsers.Remove(item);</span><br><span class="line">                <span class="keyword">await</span> Clients.AllExcept(item.ConnectionId).SendAsync(<span class="string">"onDisconnected"</span>, item.Name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>This is the main signalr hub that will communicate with all the clients and also make the API calls to Translation Library to translate the text. The constructor based dependency injection loads the TypedHttpClient object that are configured in Startup.cs to make the http API calls.<br><strong>Connect</strong> Method will be called when ever the new user is connected and its adds the users into the static list (Preferably to store in concurrent dictionary to avoid multi thread locking issues) and also add to the signalr group based the launguage the user is selected. It also sends the message back to caller with the list of users so that it will be populating user panel on the UI side. It also sends the notification to all the other users that new user is joined the chat.<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> Groups.AddToGroupAsync(id, language);</span><br><span class="line"><span class="keyword">await</span> Clients.Caller.SendAsync(<span class="string">"onConnected"</span>, ConnectedUsers, name, id);</span><br><span class="line"><span class="keyword">await</span> Clients.AllExcept(id).SendAsync(<span class="string">"onNewUserConnected"</span>, name);</span><br></pre></td></tr></table></figure></p>
<p><strong>Disconnect</strong> Method gets called when the user exits the chats. It removes the user from the list and also notifies all the other users.<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ConnectedUsers.Remove(item);</span><br><span class="line"><span class="keyword">await</span> Clients.AllExcept(item.ConnectionId).SendAsync(<span class="string">"onDisconnected"</span>, item.Name);</span><br></pre></td></tr></table></figure></p>
<p><strong>SendMessage</strong> Method will be called whenever user enters the message and it makes the API calls to translation service to get the translated text in each languages and sends the associated translated text to each group.</p>
<h2 id="Create-and-Consume-Cognitive-Services-in-Azure-Free-Tier"><a href="#Create-and-Consume-Cognitive-Services-in-Azure-Free-Tier" class="headerlink" title="Create and Consume Cognitive Services in Azure (Free Tier)"></a>Create and Consume Cognitive Services in Azure (Free Tier)</h2><ul>
<li>Login to Azure Portal and Search for cognitive service and select Cognitive Services.</li>
</ul>
<p><a href="https://lh3.googleusercontent.com/-jX_2RiwlPlU/WxgwSSL2VfI/AAAAAAAGsw0/GIUH_wRrJhsh0MX47lwO16LobIrD-h-kgCHMYCw/s1600-h/1%255B3%255D" target="_blank" rel="noopener"><img src="https://lh3.googleusercontent.com/-gQi-ABxwYjA/WxgwUxxY2CI/AAAAAAAGsw4/IEJVtVz3D5QIoNdRSa_X3dTUNzIMMvmZACHMYCw/1_thumb%255B1%255D?imgmax=800" alt="1" title="1"></a></p>
<ul>
<li>Click Add Button and Search for Translator Text and Select it and click the Create Button.</li>
</ul>
<p><a href="https://lh3.googleusercontent.com/-IxgvkIAhdRU/WxgwXW6ZTcI/AAAAAAAGsw8/WT8vYhdksYccMRwSEap_sOzM3fdiQ5VlQCHMYCw/s1600-h/1.1%255B4%255D" target="_blank" rel="noopener"><img src="https://lh3.googleusercontent.com/-hdnP1JOxd4A/WxgwaPgOcQI/AAAAAAAGsxA/Xj4FqbgtN5M4Fx7GSHXpeRGsc-TIZiYhACHMYCw/1.1_thumb%255B2%255D?imgmax=800" alt="1.1" title="1.1"></a></p>
<ul>
<li><p>You can select the Free Tier for Development purpose. It allows upto 2Million characters to translate per month in Free Tier.<br><a href="https://lh3.googleusercontent.com/-wecbJE83KNw/Wxgwb7h4SqI/AAAAAAAGsxE/HkxwCkfRvygXynAvh5AaRg37zdnfwRx5ACHMYCw/s1600-h/Pricing_Tier%255B3%255D" target="_blank" rel="noopener"><img src="https://lh3.googleusercontent.com/-8ShphCc0EFM/WxgwenjT0bI/AAAAAAAGsxI/o7GdGBI3vjwbLiNPwAKPtD5Jdk_608pDACHMYCw/Pricing_Tier_thumb%255B1%255D?imgmax=800" alt="Pricing_Tier" title="Pricing_Tier"></a></p>
</li>
<li><p>After the Cognitive Service is created, you can obtain the Subscription Keys from the Quick Start Menu.</p>
</li>
</ul>
<p><a href="https://lh3.googleusercontent.com/-ATamoUPdfk4/WxgwglaD8mI/AAAAAAAGsxM/77IWq7K4B7Iciau9ShpxkuQ5Dz0P8qygQCHMYCw/s1600-h/2%255B4%255D" target="_blank" rel="noopener"><img src="https://lh3.googleusercontent.com/-SBFmGqHxSvw/WxgwikiJUBI/AAAAAAAGsxU/5Q8qC3vA7Kg6Nuoor0m17fdWJIy56uJ_ACHMYCw/2_thumb%255B2%255D?imgmax=800" alt="2" title="2"></a></p>
<ul>
<li>By default , two keys will be provided. you can copy the key1 value and put it in usersecrets.json for the application to access it.</li>
</ul>
<p><a href="https://lh3.googleusercontent.com/-YuyNmpYetuw/WxgwlN7cdAI/AAAAAAAGsxY/phwjn9Dnsq0NDMNoUfulqXpYz49FzGn_QCHMYCw/s1600-h/3%255B7%255D" target="_blank" rel="noopener"><img src="https://lh3.googleusercontent.com/-koHx0nz4gUs/WxgwnYekzoI/AAAAAAAGsxc/eRIhChSgBm8nMOXaxjUHa-PwQy6csOt3wCHMYCw/3_thumb%255B3%255D?imgmax=800" alt="3" title="3"></a><br>Now that, we have completed setting up the Translator Service in Azure, we will switch back to code to consume the API Service. We will be using TypedHttpClient to consume the web service. Typed clients are custom classes with HttpClient injected in the constructor. This will be wired up within the DI system by adding generic AddHttpClient method in Startup.cs with the custom type. Another advantage of having typed client is that we can encapsulate the all the HTTP calls inside specific business methods like SendMessage, GetSupportedLanguages.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CognitiveServiceClient</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> HttpClient _client;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="keyword">string</span> _apiKey;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="keyword">string</span> _apiVersion;</span><br><span class="line">        <span class="keyword">private</span> ILogger&lt;cognitiveserviceclient&gt; _logger;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">CognitiveServiceClient</span>(<span class="params">HttpClient client, ILogger&lt;cognitiveserviceclient&gt; logger, IConfiguration config</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            _client = client;</span><br><span class="line">            _client.BaseAddress = <span class="keyword">new</span> Uri(config[<span class="string">"AppSettings:APIBaseURL"</span>]);</span><br><span class="line">            _apiVersion = config[<span class="string">"AppSettings:APIVersion"</span>];</span><br><span class="line">            _apiKey = config[<span class="string">"AppSettings:SubscriptionKey"</span>];</span><br><span class="line">            _logger = logger;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;List Language&gt; GetSupportedLanguages()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> languages = <span class="keyword">new</span> List&lt;Language&gt;();</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> languagesUrl = <span class="keyword">new</span> Uri(<span class="string">$"/languages?api-version=<span class="subst">&#123;_apiVersion&#125;</span>"</span>, UriKind.Relative);</span><br><span class="line">                <span class="keyword">var</span> res = <span class="keyword">await</span> _client.GetAsync(languagesUrl);</span><br><span class="line">                res.EnsureSuccessStatusCode();</span><br><span class="line">                <span class="keyword">var</span> jsonResults = <span class="keyword">await</span> res.Content.ReadAsStringAsync();</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">dynamic</span> entity = JObject.Parse(jsonResults);</span><br><span class="line">                <span class="keyword">foreach</span> (JProperty property <span class="keyword">in</span> entity.translation.Properties())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">dynamic</span> langDetail = JObject.Parse(property.Value.ToString());</span><br><span class="line">                    <span class="keyword">var</span> language = <span class="keyword">new</span> Language();</span><br><span class="line">                    language.Code = property.Name;</span><br><span class="line">                    language.Name = langDetail.name;</span><br><span class="line">                    languages.Add(language);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> languages;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (HttpRequestException ex)</span><br><span class="line">            &#123;</span><br><span class="line">                _logger.LogError(<span class="string">$"An error occurred connecting to CognitiveService API <span class="subst">&#123;ex.ToString()&#125;</span>"</span>);</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;List TranslationResult&gt; Translate(<span class="keyword">string</span> message, <span class="keyword">string</span> languages)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                System.Object[] body = <span class="keyword">new</span> System.Object[] &#123; <span class="keyword">new</span> &#123; Text = message &#125; &#125;;</span><br><span class="line">                <span class="keyword">var</span> requestBody = JsonConvert.SerializeObject(body);</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">var</span> translateUrl = <span class="keyword">new</span> Uri(<span class="string">$"/translate?api-version=<span class="subst">&#123;_apiVersion&#125;</span>&amp;<span class="subst">&#123;languages&#125;</span>"</span>, UriKind.Relative);</span><br><span class="line">                 </span><br><span class="line">                <span class="keyword">string</span> jsonResults = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">using</span> (<span class="keyword">var</span> request = <span class="keyword">new</span> HttpRequestMessage())</span><br><span class="line">                &#123;</span><br><span class="line">                    request.Method = HttpMethod.Post;</span><br><span class="line">                    request.RequestUri = translateUrl;</span><br><span class="line">                    request.Content = <span class="keyword">new</span> StringContent(requestBody, Encoding.UTF8, <span class="string">"application/json"</span>);</span><br><span class="line">                    request.Headers.Add(<span class="string">"Ocp-Apim-Subscription-Key"</span>, _apiKey);</span><br><span class="line"> </span><br><span class="line">                    <span class="keyword">var</span> res = <span class="keyword">await</span> _client.SendAsync(request);                   </span><br><span class="line">                    jsonResults = <span class="keyword">await</span> res.Content.ReadAsStringAsync();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> JsonConvert.DeserializeObject&lt;list TranslationResult&gt;(jsonResults);</span><br><span class="line">                     </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (HttpRequestException ex)</span><br><span class="line">            &#123;</span><br><span class="line">                _logger.LogError(<span class="string">$"An error occurred connecting to CognitiveService API <span class="subst">&#123;ex.ToString()&#125;</span>"</span>);</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p> <strong>GetSupportedLanguages</strong> method will make the API calls to get the list of supported languages.<br><strong>Translate</strong> method takes the message and list of languages to translate and return the json output translation text array all the requested languages.</p>
<h2 id="Additional-Points"><a href="#Additional-Points" class="headerlink" title="Additional Points"></a>Additional Points</h2><ul>
<li><p>In Startup.cs, make sure to add the below code in ConfigureServices method.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">services.AddSignalR();</span><br><span class="line">services.AddHttpClient&lt;cognitiveserviceclient&gt;();</span><br></pre></td></tr></table></figure>
</li>
<li><p>In the Configure method, add the following,</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.UseSignalR(routes =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                routes.MapHub&lt;chathub&gt;(<span class="string">"/chathub"</span>);</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure>
<p>In the IndexModel.cs , we will have the implementation for GET method to return the list of supported languages.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> CognitiveServiceClient _client;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="title">IndexModel</span>(<span class="params">CognitiveServiceClient Client</span>)</span></span><br><span class="line"><span class="function"></span>      &#123;</span><br><span class="line">          _client = Client;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      [<span class="meta">BindProperty</span>]</span><br><span class="line">      <span class="keyword">public</span> User user &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">public</span> SelectList LanguageSL &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">OnGetAsync</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>      &#123;</span><br><span class="line">          <span class="keyword">await</span> GetLanguages();</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> Task <span class="title">GetLanguages</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>      &#123;</span><br><span class="line">          LanguageSL = <span class="keyword">new</span> SelectList(<span class="keyword">await</span> _client.GetSupportedLanguages(),<span class="keyword">nameof</span>(Language.Code),<span class="keyword">nameof</span>(Language.Name));</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>Finally, this can be tested by running the application in multiple window with different username and languages are selected so that both window can send and receives the message in their selected language in realtime. The same application can be hosted in Azure as a web app with our local signalR hub or use the <a href="https://azure.microsoft.com/en-us/services/signalr-service/" target="_blank" rel="noopener">Azure SignalR service</a>.  </p>
<p>In future, it is very much possible to see this realtime translation feature in every apps including the most popular messaging apps like whatsapp when the group chat is having people who speak different region languages and enabling automatic translation settings would help a lot.  </p>
<p>I have posted entire source code in my <a href="https://github.com/vavjeeva/RealTimeTranslationChat/" target="_blank" rel="noopener">github</a> library.<br>Happy Coding!!!</p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/C/" rel="tag"># C#</a>
          
            <a href="/tags/Net-Core/" rel="tag"># .Net Core</a>
          
            <a href="/tags/Azure/" rel="tag"># Azure</a>
          
            <a href="/tags/SignalR/" rel="tag"># SignalR</a>
          
            <a href="/tags/HttpClient/" rel="tag"># HttpClient</a>
          
            <a href="/tags/CognitiveService/" rel="tag"># CognitiveService</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/21/parser-api-using-net-core-web-api-21/" rel="next" title="Parser API using .Net Core Web API 2.1 and Hosting in Raspberry PI">
                <i class="fa fa-chevron-left"></i> Parser API using .Net Core Web API 2.1 and Hosting in Raspberry PI
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/07/11/magic-paste-universal-paste-data-to-web/" rel="prev" title="Real Time Communication to Cross Platform Devices using Azure SignalR Service">
                Real Time Communication to Cross Platform Devices using Azure SignalR Service <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Jeeva Subburaj">
            
              <p class="site-author-name" itemprop="name">Jeeva Subburaj</p>
              <div class="site-description motion-element" itemprop="description">Programmer, Blogger</div>
          </div>

          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/vavjeeva" title="GitHub &rarr; https://github.com/vavjeeva" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:vavjeeva@gmail.com" title="E-Mail &rarr; mailto:vavjeeva@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://twitter.com/vavjeeva" title="Twitter &rarr; https://twitter.com/vavjeeva" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://linkedin.com/in/jeevasubburaj" title="LinkedIn &rarr; https://linkedin.com/in/jeevasubburaj" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://stackoverflow.com/users/79442/jeeva-subburaj" title="StackOverflow &rarr; https://stackoverflow.com/users/79442/jeeva-subburaj" rel="noopener" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
	  
	  
		<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
		<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
		<div class="widget-wrap">			
			<div id="myCanvasContainer" class="widget tagcloud">
				<canvas width="250" height="250" id="resCanvas" style="width=100%">
					<ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Net/">.Net</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Net-Core/">.Net Core</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Asp-Net-Core/">Asp.Net Core</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Azure/">Azure</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AzureFunctions/">AzureFunctions</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C#</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CognitiveService/">CognitiveService</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HiddenGems/">HiddenGems</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HttpClient/">HttpClient</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kotlin/">Kotlin</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NodeJS/">NodeJS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Performance/">Performance</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Raspberry-PI/">Raspberry PI</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL-Server/">SQL Server</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SignalR/">SignalR</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tips/">Tips</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Xamarin/">Xamarin</a><span class="tag-list-count">1</span></li></ul>
				</canvas>
			</div>
		</div>
		

      	  	  
    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jeeva Subburaj</span>

  

  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>




  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  
  
  <script id="dsq-count-scr" src="https://jeevasubburaj.disqus.com/count.js" async></script>


<script>
  var disqus_config = function() {
    this.page.url = "https://jeevasubburaj.com/2018/06/06/real-time-language-translation-chat/";
    this.page.identifier = "2018/06/06/real-time-language-translation-chat/";
    this.page.title = 'Real time Language Translation chat using SignalR and Azure Cognitive Services and TypedHttpClient - .Net Core 2.1';
    };
  function loadComments() {
    var d = document, s = d.createElement('script');
    s.src = 'https://jeevasubburaj.disqus.com/embed.js';
    s.setAttribute('data-timestamp', '' + +new Date());
    (d.head || d.body).appendChild(s);
  }
  
    $(function() {
      var offsetTop = $('#comments').offset().top - $(window).height();
      if (offsetTop <= 0) {
        // load directly when there's no a scrollbar
        loadComments();
      } else {
        $(window).on('scroll.disqus_scroll', function() {
          // offsetTop may changes because of manually resizing browser window or lazy loading images.
          var offsetTop = $('#comments').offset().top - $(window).height();
          var scrollTop = $(window).scrollTop();

          // pre-load comments a bit? (margin or anything else)
          if (offsetTop - scrollTop < 60) {
            $(window).off('.disqus_scroll');
            loadComments();
          }
        });
      }
    });
  
</script>





  


  




  

  

  

  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('Copy');
      }, 300);
    }).append(e);
  })
</script>


</body>
</html>
